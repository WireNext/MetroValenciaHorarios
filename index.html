<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Horarios Metro Valencia</title>
<style>
  body {
    background-color: #121212;
    color: #e0e0e0;
    font-family: Arial, sans-serif;
    margin: 20px;
  }
  h1 {
    text-align: center;
    margin-bottom: 1rem;
  }
  .linea {
    cursor: pointer;
    background-color: #1f1f1f;
    border: none;
    outline: none;
    width: 100%;
    text-align: left;
    padding: 12px 20px;
    margin-bottom: 5px;
    font-size: 1.2rem;
    border-left: 8px solid;
    transition: background-color 0.3s ease;
  }
  .linea:hover {
    background-color: #333333;
  }
  .paradas {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
    background-color: #222222;
    margin-bottom: 10px;
    border-radius: 0 0 8px 8px;
  }
  .paradas.visible {
    max-height: 1000px; /* suficiente para desplegar */
  }
  .parada {
    padding: 10px 40px;
    border-bottom: 1px solid #333;
    font-size: 1rem;
    display: flex;
    justify-content: space-between;
  }
  .parada:last-child {
    border-bottom: none;
  }
  .hora {
    color: #81c784;
    font-weight: bold;
  }
</style>
</head>
<body>

<h1>Próximos metros - Metro Valencia</h1>

<div id="contenedorLineas"></div>

<script>
// Ejemplo mínimo de colores para líneas, se pueden añadir más o generar dinámicamente
const coloresLineas = {
  "1": "#e53935",  // rojo
  "2": "#1e88e5",  // azul
  "3": "#43a047",  // verde
  "4": "#fdd835",  // amarillo
  "5": "#8e24aa",  // morado
  "6": "#fb8c00",  // naranja
  "7": "#00acc1",  // cyan
  "8": "#d81b60",  // rosa
  "9": "#546e7a"   // gris azulado
};

// Función para asignar color si no está en coloresLineas (opcional)
function getColor(linea) {
  if (coloresLineas[linea]) return coloresLineas[linea];
  // Si no hay color definido, generar uno random pastel
  const randomHue = Math.floor(Math.random() * 360);
  return `hsl(${randomHue}, 70%, 60%)`;
}

// Aquí va tu JSON con los datos horarios (o cargarlo con fetch)
const datos = [
  {
    "stop_id": 55,
    "stop_name": "Empalme",
    "route_id": "V2-107-44",
    "route_short_name": 2,
    "route_long_name": "2 - Torrent Avinguda - Paterna",
    "next_arrival": "18:31:00"
  },
  {
    "stop_id": 54,
    "stop_name": "Beniferri",
    "route_id": "V1-36-20",
    "route_short_name": 1,
    "route_long_name": "1 - Seminari - CEU - València Sud",
    "next_arrival": "18:30:00"
  },
  // ... añade todos tus datos aquí ...
];

// Agrupar datos por línea
const lineasMap = {};
datos.forEach(item => {
  const linea = item.route_short_name.toString();
  if (!lineasMap[linea]) {
    lineasMap[linea] = {
      nombre: item.route_long_name,
      color: getColor(linea),
      paradas: []
    };
  }
  lineasMap[linea].paradas.push({
    stop_name: item.stop_name,
    next_arrival: item.next_arrival
  });
});

const contenedor = document.getElementById('contenedorLineas');

Object.entries(lineasMap).forEach(([linea, info]) => {
  const btn = document.createElement('button');
  btn.className = 'linea';
  btn.style.borderLeftColor = info.color;
  btn.textContent = `Línea ${linea}: ${info.nombre}`;

  const divParadas = document.createElement('div');
  divParadas.className = 'paradas';

  info.paradas.forEach(p => {
    const divP = document.createElement('div');
    divP.className = 'parada';
    divP.innerHTML = `<span>${p.stop_name}</span> <span class="hora">${p.next_arrival}</span>`;
    divParadas.appendChild(divP);
  });

  btn.addEventListener('click', () => {
    divParadas.classList.toggle('visible');
  });

  contenedor.appendChild(btn);
  contenedor.appendChild(divParadas);
});
</script>

</body>
</html>
